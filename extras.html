<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Extras • thekeelan.co.uk</title>
<meta name="theme-color" content="#0b0f14" />
<style>
:root{--text:#e9eef5;--muted:#9aa6b2;--card:#12161b;--border:#1e242c}
*{box-sizing:border-box}body{margin:0;color:var(--text);background:#0b0f14;font:14px/1.55 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial}
header{display:flex;justify-content:space-between;align-items:center;padding:10px 14px;border-bottom:1px solid var(--border)}
a{color:var(--text);text-decoration:none}
.grid{display:grid;grid-template-columns:1fr 1fr;gap:16px;padding:14px}
@media (max-width:900px){.grid{grid-template-columns:1fr}}
.card{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:14px}
h2{margin:0 0 10px}.muted{color:var(--muted)}
.item{display:flex;gap:12px;align-items:center;border-top:1px solid var(--border);padding:10px 0}
.item:first-child{border-top:0}
.item img{width:72px;height:32px;object-fit:cover;border-radius:6px;border:1px solid #000}
.badge{background:#0f141a;border:1px solid #26313f;border-radius:6px;padding:3px 6px;font-size:12px}
</style>
</head>
<body>
<header>
  <div><a href="/">Football</a> · <strong>Extras</strong></div>
  <div class="muted" id="when">—</div>
</header>

<div class="grid">
  <section class="card">
    <h2>Leeds Weather</h2>
    <div id="wx" class="muted">Loading…</div>
  </section>

  <section class="card">
    <h2>Steam Specials</h2>
    <div id="steam" class="muted">Loading…</div>
  </section>

  <section class="card" style="grid-column:1 / -1">
    <h2>My Spotify Playlist</h2>
    <iframe style="border-radius:12px" src="https://open.spotify.com/embed/playlist/2Ap76LC4PX2HUyTW2VXe9u"
      width="100%" height="352" frameborder="0" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"
      loading="lazy"></iframe>
  </section>
</div>

<script>
(async ()=>{
  const bust = `?t=${Date.now()}`;
  const j = async p => (await fetch(p + bust, {cache:'no-store'})).json().catch(()=>null);
  const t = async p => (await fetch(p + bust, {cache:'no-store'})).text().catch(()=>'');

  // stamp
  const when = document.getElementById('when');
  when.textContent = 'Updated: ' + (await t('/assets/update_stamp.txt')).trim();

  // weather
  const wx = await j('/assets/weather.json');
  const wxBox = document.getElementById('wx');
  if (!wx?.current){
    wxBox.textContent = 'No data.';
  } else {
    const c = wx.current;
    wxBox.innerHTML = `
      <div style="font-size:32px">${Math.round(c.temperature_2m)}°C</div>
      <div>Wind ${Math.round(c.wind_speed_10m)} mph</div>
    `;
  }

  // steam specials
  const sp = await j('/assets/steam_specials.json');
  const spBox = document.getElementById('steam');
  if (!sp?.specials?.length){
    spBox.textContent = 'No specials right now.';
  } else {
    spBox.classList.remove('muted');
    spBox.innerHTML = sp.specials.slice(0,10).map(it => `
      <div class="item">
        <img src="${it.capsule_image}" alt="">
        <div style="flex:1">
          <div>${it.name}</div>
          <div class="muted">-${it.discount_percent||0}%</div>
        </div>
        <a class="badge" href="${it.url}" target="_blank" rel="noopener">View</a>
      </div>`).join('');
  }
})();
</script>
</body>
</html>
