<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Extras</title>
<meta name="theme-color" content="#0b0f14">
<style>
  :root{--text:#e9eef5;--muted:#9aa6b2;--card:#12161b;--border:#1e242c}
  body{margin:0;background:#0b0f14;color:var(--text);font:14px/1.55 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial}
  header{display:flex;justify-content:space-between;align-items:center;padding:14px 18px;border-bottom:1px solid var(--border)}
  .grid{display:grid;gap:18px;padding:18px;grid-template-columns:1.2fr 1fr}
  @media (max-width:1000px){.grid{grid-template-columns:1fr}}
  .card{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:14px}
  .muted{color:var(--muted)}
  .deal{display:grid;grid-template-columns:64px 1fr auto;gap:10px;align-items:center;border-bottom:1px solid var(--border);padding:10px 0}
  .deal img{width:64px;height:32px;object-fit:cover;border-radius:6px}
  .pill{border:1px solid var(--border);padding:2px 6px;border-radius:999px}
</style>
</head>
<body>
<header>
  <div>thekeelan.co.uk</div>
  <nav><a href="/" style="color:var(--muted);text-decoration:none">Football</a></nav>
</header>

<div class="grid">
  <section class="card">
    <h2>Leeds Weather</h2>
    <div id="weather" class="muted">Loading…</div>
  </section>

  <section class="card">
    <h2>Steam Specials</h2>
    <div id="deals" class="muted">Loading…</div>
  </section>
</div>

<script>
(async () => {
  const bust = `?t=${Date.now()}`;
  async function getJSON(name){
    for (const p of [`/assets/${name}`, `assets/${name}`, `./assets/${name}`]){
      try{ const r=await fetch(p+bust,{cache:'no-store'}); if(r.ok) return r.json(); }catch{}
    }
    return null;
  }

  // weather
  const wx = await getJSON('weather.json');
  const w = document.getElementById('weather');
  if(!wx?.current){ w.textContent='No weather data.'; }
  else {
    const c = wx.current;
    w.innerHTML = `<div style="font-size:22px">${Math.round(c.temperature_2m)}°C</div>
                   <div class="muted">Wind ${Math.round(c.wind_speed_10m)} mph</div>`;
  }

  // steam deals
  const deals = await getJSON('steam_deals.json');
  const d = document.getElementById('deals');
  if(!deals?.deals?.length){ d.textContent='No specials right now.'; }
  else {
    d.classList.remove('muted');
    d.innerHTML = deals.deals.map(g=>`
      <div class="deal">
        <img src="${g.capsule_image||''}" alt="">
        <div>
          <div>${g.title}</div>
          <a href="${g.url}" target="_blank" rel="noopener noreferrer" class="muted">${g.url}</a>
        </div>
        <div><span class="pill">-${g.discount_percent}%</span></div>
      </div>
    `).join('');
  }
})();
</script>
</body>
</html>
